m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 313|yday==314]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
p <- dt %>%
ggplot( aes(x = yhour, y = ME_FC/1000000)) +
geom_point() +
ggtitle("") +
theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
ggplotly(p)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219027000.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 313|yday==314]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
p <- dt %>%
ggplot( aes(x = yhour, y = ME_FC/1000000)) +
geom_point() +
ggtitle("") +
theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
ggplotly(p)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219027000.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
p <- dt %>%
ggplot( aes(x = yhour, y = ME_FC/1000000)) +
geom_point() +
ggtitle("") +
theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
ggplotly(p)
temp=fread('/Volumes/Samsung\ SSD/abnormal/2020temp.csv')
day313 = temp[yday == 313]
day313 %>%
ggplot( aes(x = mmsi, y = ME_FC/1000000)) +
geom_point() +
ggtitle("") +
# theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/356283000.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
p <- dt %>%
ggplot( aes(x = yhour, y = ME_FC/1000000)) +
geom_point() +
ggtitle("") +
theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
ggplotly(p)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/	477220400.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/477220400.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
p <- dt %>%
ggplot( aes(x = yhour, y = ME_FC/1000000)) +
geom_point() +
ggtitle("") +
theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
ggplotly(p)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/255805855.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
p <- dt %>%
ggplot( aes(x = yhour, y = ME_FC/1000000)) +
geom_point() +
ggtitle("") +
theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
ggplotly(p)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/368305000.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
p <- dt %>%
ggplot( aes(x = yhour, y = ME_FC/1000000)) +
geom_point() +
ggtitle("") +
theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
ggplotly(p)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/538007617.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
# p <- dt %>%
#   ggplot( aes(x = yhour, y = ME_FC/1000000)) +
#   geom_point() +
#   ggtitle("") +
#   theme_ipsum() +
#   ylab("FC") +
#   # geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
#   theme( )
# ggplotly(p)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/255805864.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
# p <- dt %>%
#   ggplot( aes(x = yhour, y = ME_FC/1000000)) +
#   geom_point() +
#   ggtitle("") +
#   theme_ipsum() +
#   ylab("FC") +
#   # geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
#   theme( )
# ggplotly(p)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/366791000.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
# p <- dt %>%
#   ggplot( aes(x = yhour, y = ME_FC/1000000)) +
#   geom_point() +
#   ggtitle("") +
#   theme_ipsum() +
#   ylab("FC") +
#   # geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
#   theme( )
# ggplotly(p)
View(dt)
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/636017506.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219018765.gz",sep = ',')
# dt=fread("/Volumes/Samsung SSD/AIS/2020EM/219036000.gz",sep = ',')
dt=fread("/Volumes/Samsung SSD/AIS/2020EM/357104000.gz",sep = ',')
# 219027000
#
# fwrite((dt),paste('/Volumes/Samsung\ SSD/abnormal/SHIP_3.csv',sep = ''),sep = ',',append = T)
library(leaflet)
dt = dt[yday == 312|yday == 313|yday==314|yday == 315]
# Create a color palette with handmade bins.
mypalette <- colorBin( palette="YlOrBr", domain=dt$ME_FC/1000000, na.color="transparent")
# Prepare the text for the tooltip:
mytext <- paste(
"Time: ", dt$datetime, "<br/>",
"Hour: ", dt$durhour, "<br/>",
"Distnm: ", dt$distnm, "<br/>",
"Speed: ", dt$avgspeed, "<br/>",
"AddDay:",dt$isaddedday, "<br/>",
"ME_FC: ", dt$ME_FC/1000000, "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Final Map
m <- leaflet(dt) %>%
addTiles()  %>%
# setView( lat=-27, lng=170 , zoom=4) %>%
addProviderTiles("Esri.WorldImagery") %>%
addCircleMarkers(~lon, ~lat,
fillColor = ~mypalette(ME_FC/1000000), fillOpacity = 0.6, color="white", radius=9, stroke=FALSE,
label = mytext,
labelOptions = labelOptions( style = list("font-weight" = "normal", padding = "3px 8px"), textsize = "13px", direction = "auto")
) %>%
addLegend( pal=mypalette, values=~ME_FC/1000000, opacity=0.9, title = "FC/t", position = "bottomright" )
m
# p <- dt %>%
#   ggplot( aes(x = yhour, y = ME_FC/1000000)) +
#   geom_point() +
#   ggtitle("") +
#   theme_ipsum() +
#   ylab("FC") +
#   # geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
#   theme( )
# ggplotly(p)
yday2019=fread("/Volumes/Samsung\ SSD/汇总结果/fix/2019yday_sum.csv",fill=TRUE)%>%na.omit(.)
yday2019 = yday2019[,year:=2019]
# fwrite(yday2019,paste('/Volumes/Samsung\ SSD/汇总结果/2019yday_sum.csv'),sep = ',',append = T)
# yday2020=fread("~/论文数据/2020yday.csv",sep = ',')%>%na.omit(.)
yday2020=fread("/Volumes/Samsung\ SSD/汇总结果/fix/2020yday_sum.csv",fill=TRUE)%>%na.omit(.)
yday2020 = yday2020[,year:=2020]
yday_dt =  rbind(yday2019,yday2020)
yday_dt$year = as.character(yday_dt$year)
yday_dt[,4:13]=yday_dt[,4:13]/1000000 # 单位吨
p <- yday_dt %>%
ggplot( aes(x = yday,group = year, y = FC, color= year)) +
geom_line() +
ggtitle("") +
theme_ipsum() +
ylab("FC") +
# geom_label( x=1990, y=55000, label="Amanda reached 3550\nbabies in 1970", size=4, color="#69b3a2") +
theme( )
ggplotly(p)
install.packages(c("cli", "collections", "curl", "explore", "fpc", "fstcore", "httpuv", "languageserver", "lm.beta", "lwgeom", "mapproj", "mongolite", "parallelly", "progressr", "purrr", "ragg", "raster", "rasterVis", "RcppParallel", "RcppTOML", "repr", "reticulate", "rgdal", "rgl", "RPresto", "rtweet", "s2", "shinyWidgets", "sparsesvd", "stringi", "survival", "svglite", "tidytext", "timechange", "xgboost"))
install.packages(c("cli", "collections", "curl", "explore", "fpc", "fstcore", "httpuv", "languageserver", "lm.beta", "lwgeom", "mapproj", "mongolite", "parallelly", "progressr", "purrr", "ragg", "raster", "rasterVis", "RcppParallel", "RcppTOML", "repr", "reticulate", "rgdal", "rgl", "RPresto", "rtweet", "s2", "shinyWidgets", "sparsesvd", "stringi", "survival", "svglite", "tidytext", "timechange", "xgboost"))
install.packages(c("cli", "collections", "curl", "explore", "fpc", "fstcore", "httpuv", "languageserver", "lm.beta", "lwgeom", "mapproj", "mongolite", "parallelly", "progressr", "purrr", "ragg", "raster", "rasterVis", "RcppParallel", "RcppTOML", "repr", "reticulate", "rgdal", "rgl", "RPresto", "rtweet", "s2", "shinyWidgets", "sparsesvd", "stringi", "survival", "svglite", "tidytext", "timechange", "xgboost"))
